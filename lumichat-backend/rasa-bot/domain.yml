version: "3.1"

intents:
  - greet
  - express_sadness
  - express_anxiety
  - express_stress
  - express_happiness
  - book_appointment
  - crisis_help
  - thank
  - goodbye
  - smalltalk
  - affirm
  - deny
  - out_of_scope
  - nlu_fallback
  - inform_date         # used during the appointment form
  - inform_time         # used during the appointment form

entities:
  - date
  - time

slots:
  appointment_date:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: date
      - type: from_text
        conditions:
          - active_loop: appointment_form
            requested_slot: appointment_date

  appointment_time:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: time
      - type: from_text
        conditions:
          - active_loop: appointment_form
            requested_slot: appointment_time

  consent:
    type: text
    influence_conversation: true
    mappings:
      - type: from_intent
        value: "yes"
        intent: affirm
      - type: from_intent
        value: "no"
        intent: deny
      - type: from_text
        conditions:
          - active_loop: appointment_form
            requested_slot: consent

forms:
  appointment_form:
    required_slots:
      - appointment_date
      - appointment_time
      - consent

responses:
  utter_fallback:
    - text: "I didn’t quite get that, but I’m here to listen. Could you say it another way? / Wala kaayo nako masabti, pero ania ko maminaw. Pwede nimo usbon pagpasabot?"

  utter_greet:
    - text: "Hi! I’m LumiCHAT. I’m here to listen and support you. How are you feeling today? / Kumusta? Andam ko maminaw ug motabang."

  # Crisis flow
  utter_crisis_intro:
    - text: "I’m really glad you reached out. Your safety is the top priority right now. / Salamat sa pag-reach out—imong kaluwasan ang pinaka-importante karon."
  utter_crisis_hotlines:
    - text: "If you’re in immediate danger, contact local emergency services. Hopeline PH 24/7: 0917-558-4673 / (02) 804-4673. / Kung emerhensya, tawag dayon sa local emergency services."
  utter_crisis_next_steps:
    - text: "I can help you connect with our counselor—would you like to proceed to the appointment page now? / Matabangan tika maka-connect sa counselor—gusto ka mo-padayon sa appointment page karon?"

  # Closers / smalltalk
  utter_thanks:
    - text: "You’re welcome. I’m here anytime. / Walay sapayan—ania ra ko permi."
  utter_goodbye:
    - text: "Take care. Message me anytime. / Amping—pwede ra ka mo-chat kanunay."
  utter_smalltalk_default:
    - text: "I’m LumiCHAT, your student support assistant. I can listen and help you book a counselor. / Ako si LumiCHAT—maminaw ko ug motabang sa pag-book sa counselor."

  utter_out_of_scope:
    - text: "I’m focused on well-being and counseling support. I can help you talk through feelings or book an appointment. / Nakatutok ko sa kaayuhan ug counseling support—maka-tabang ko makig-istorya o mag-book ug appointment."

actions:
  - action_reflective_support
  - action_submit_appointment
  - validate_appointment_form
  - action_ask_appointment_date   # NEW
  - action_ask_appointment_time   # NEW
  - action_ask_consent            # NEW

session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: true
